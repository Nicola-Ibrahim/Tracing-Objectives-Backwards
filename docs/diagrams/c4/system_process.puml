@startuml
'----------------------------------------------------
' Layout & Style
'----------------------------------------------------
top to bottom direction
skinparam componentStyle rectangle
skinparam roundcorner 20
skinparam shadowing true
skinparam backgroundColor #F0F0F0

skinparam component {
  BorderColor #333333
  FontSize 12
  FontName Arial
  BackgroundColor<<Input>> #D6EAF8
  BackgroundColor<<Encoder>> #AED6F1
  BackgroundColor<<Latent>> #F9E79F
  BackgroundColor<<Decoder>> #A9DFBF
  BackgroundColor<<Validation>> #D7BDE2
  BackgroundColor<<Decision>> #FAD7A0
  BackgroundColor<<Action>> #F5B7B1
}

'----------------------------------------------------
' Main Components
'----------------------------------------------------
component "User Input:\nRequest + Conditions\n(e.g., Distance = 12 km,\nTime Wt = 0.7, Energy Wt = 0.3)" as B <<Input>>

'----------------------------------------------------
' Grouped: Conditional VAE
'----------------------------------------------------
package "Conditional Variational Autoencoder (CVAE)" {
  component "Encoder\n(Extract z from Fronts, c)" as C <<Encoder>>
  component "Latent Vector z +\nCondition Vector c" as D <<Latent>>
  component "Decoder\n(Generate Control u(t) | z, c)" as E <<Decoder>>
}

'----------------------------------------------------
' Remaining Components
'----------------------------------------------------
component "Control Profile u(t)\n(Planned Trajectory)" as F <<Action>>
component "Digital Twin Validator\n(Evaluate Feasibility in Sim)" as G <<Validation>>
component "Feasibility Check" as H <<Decision>>
component "Send to Monocap\n(Deploy u(t))" as I <<Action>>
component "Latent Space Adjustment\n(Retry via z′ or Interpolation)" as J <<Action>>

'----------------------------------------------------
' Connections
'----------------------------------------------------
B --> C : Feed conditions & context
C --> D : Encode z
D --> E : Decode using z & c
E --> F : Generate u(t)
F --> G : Validate trajectory
G --> H : Feasible?
H --> I : Yes → Deploy
H --> J : No → Adjust
J --> E : Retry decode with z′

@enduml
